<!DOCTYPE html SYSTEM "http://www.thymeleaf.org/dtd/xhtml1-strict-thymeleaf-spring4-4.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:th="http://www.thymeleaf.org" xmlns:v-on="http://www.w3.org/1999/xhtml" xmlns:v-bind="http://www.w3.org/1999/xhtml"
      lang="en">


<head th:replace="fragments/profiles/activeProfile :: head (pageTitle = 'UserFolders')">
    <title>PhotoPond - authorization</title>
    <!-- Required meta tags -->
    <meta charset="UTF-8">

    <title>PhotoPond - directories</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="../../../libs/bootstrap/css/bootstrap.min.css">

    <!--Font Awesome-->
    <link rel="stylesheet" href="../../../libs/font-awesome-free-5.1.1-web/css/all.css">

    <link rel="stylesheet" href="../../../css/main.css">
    <link rel="stylesheet" href="../../../css/skins/default-skin.min.css">

</head>

<body>
<object th:include="fragments/header :: header('home')" th:remove="tag"></object>

<div class="container-fluid" id="directoryApp" v-cloak>
    <div class="row">
        <div class="col-12">
            <input type="file" multiple
                   placeholder="add picture files" id="files" name="files" ref="files"
                   v-on:change="onFileUploadFinish"
                   style="display: none">
        </div>
    </div>
    <div class="row">
        <div class="col-12">
            <!--Path to breadcrumb-->
            <div class="row">
                <div class="col-12">
                    <ol class="breadcrumb mb-0">
                        <template v-for="(parent, index) in parentDirectories">
                            <li class="breadcrumb-item secondary-color" v-if="index < parentDirectories.length - 1">
                                <a v-bind:href="parent.url" v-html="parent.name"
                                   data-toggle="tooltip" data-placement="bottom" v-bind:title="parent.tooltip"></a>
                                <i class="fa fa-angle-double-right mx-2" aria-hidden="true"></i>
                            </li>
                            <li class="breadcrumb-item primary-color active" v-else>
                                <span v-html="parent.name" data-toggle="tooltip" data-placement="bottom" v-bind:title="parent.tooltip"></span>
                            </li>
                        </template>
                    </ol>
                </div>
            </div>

            <!-- Toolbar-->
            <div class="row justify-content-between mb-3">
                <div class="col-5">
                    <div class="btn-toolbar">
                        <div class="btn-group" role="group" data-toggle="tooltip" data-placement="bottom" title="Add elements">
                            <div class="btn-group-sm" role="group">
                                <button type="button" id="addElementGroupDown" class="btn btn-success dropdown-toggle no-carret"
                                        data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                    <i class="fa fa-plus"></i>
                                </button>

                                <div class="dropdown-menu" aria-labelledby="addElementGroupDown">
                                    <div class="dropdown-item" id="openUploadFilesForm" v-on:click="onFileUpload">
                                        <i class="far fa-image mr-2"></i>Add file
                                    </div>
                                    <div class="dropdown-item" id="openAddDirectoryForm" v-on:click="onCreateDirectory">
                                        <i class="far fa-folder mr-2"></i>Add directory
                                    </div>
                                </div>
                            </div>
                            <transition name="fade">
                                <div class="btn-group-sm ml-1" v-if="selectedItemCount > 0">
                                    <button type="button" class="btn btn-info"
                                            data-toggle="tooltip" data-placement="bottom" title="Rename element"
                                            id="openRenameForm" v-on:click="onRename">
                                        <i class="far fa-edit"></i>
                                    </button>
                                    <button type="button" class="btn btn-info"
                                            data-toggle="tooltip" data-placement="bottom" title="Move elements"
                                            id="openMoveForm" v-on:click="onMove">
                                        <i class="far fa-share-square"></i>
                                    </button>
                                    <button type="button" class="btn btn-danger"
                                            data-toggle="tooltip" data-placement="bottom" title="Delete elements"
                                            id="deleteBtn" v-on:click="onDelete">
                                        <i class="far fa-trash-alt"></i>
                                    </button>
                                </div>
                            </transition>
                        </div>
                    </div>
                </div>
                <div class="col d-inline-flex justify-content-end">
                    <div class="btn-group-sm" role="group">
                        <button class="btn btn-outline-secondary border-0 dropdown-toggle"
                                id="changeElementSize"
                                data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                            Size
                        </button>
                        <div class="dropdown-menu dropdown-menu-right" aria-labelledby="changeElementSize">
                            <div class="dropdown-item">
                                Small
                            </div>
                            <div class="dropdown-item">Large
                            </div>
                        </div>
                    </div>
                    <div class="btn-group-sm">
                        <div class="btn btn-sm btn-outline-secondary border-0">By name</div>
                    </div>
                    <div>
                        <i class="fa fa-arrow-up"></i>
                    </div>
                </div>
            </div>

            <!--Print subdirectories-->
            <div class="row mb-3" v-if="hasDirectory">
                <div class="col-12">
                    <div class="row">
                        <div class="col-12"><h5>Directories:</h5></div>
                    </div>
                    <div class="row">
                        <div class="col-3 userElementCard" v-for="item in sortedElements" v-if="isDirectory(item)">
                            <div class="card userElement btn btn-block"
                                 v-bind:class="{selected: item.selected}">
                                <a class="contentSrc truncate"
                                   data-toggle="tooltip" data-placement="bottom" v-bind:title="item.data.name"
                                   v-bind:href="item.data.uri">
                                    <i class="fa fa-folder" style="color: #f0cb58"></i>
                                    {{ item.data.name }}
                                </a>
                                <input type="checkbox" title="" v-model="item.selected" style="position:absolute; top: 0; left: 0;">
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!--Print Pictures-->
            <div class="row mb-3" v-if="hasFile">
                <div class="col-12">
                    <div class="row">
                        <div class="col-12"><h5>Pictures:</h5></div>
                    </div>
                    <div class="row text-center">
                        <template v-for="item in sortedElements" v-if="isFile(item)">
                            <div class="col-12 col-sm-6 col-md-3 userElementCard">
                                <div class="card userElement h-100" v-bind:class="{selected: item.selected}">
                                    <img src="#"
                                         class="contentSrc"
                                         v-bind:src="item.data.uri"/>
                                    <input title="" type="checkbox" v-model="item.selected" style="position: absolute">
                                </div>
                            </div>
                        </template>
                    </div>
                </div>
            </div>

        </div>
    </div>


    <single-input-modal-form inline-template
                             id="createDirectory"
                             th:attr="custom-header=#{admin.allUsers.deleting.title},
                                        error-message=#{admin.allUsers.deleting.error},
                                        success-button-title='Create',
                                        message='New directory name'"
                             v-bind:operation-in-progress="dialogOperationInProgress"
                             v-bind:error-code="errorCode"
                             v-model:value="editedValue"
                             v-on:clear-error-code="clearErrorCode"
                             v-on:success="onCreateDirectorySuccess">
        <div th:insert="~{fragments/singleInputModalForm :: singleInputModalForm}"></div>
    </single-input-modal-form>

    <single-input-modal-form inline-template
                             id="renameItem"
                             th:attr="custom-header=#{admin.allUsers.deleting.title},
                                        error-message=#{admin.allUsers.deleting.error},
                                        success-button-title='Rename',
                                        message='New name'"
                             v-bind:operation-in-progress="dialogOperationInProgress"
                             v-bind:error-code="errorCode"
                             v-model:value="editedValue"
                             v-on:clear-error-code="clearErrorCode"
                             v-on:success="onRenameSuccess">
        <div th:insert="~{fragments/singleInputModalForm :: singleInputModalForm}"></div>
    </single-input-modal-form>

    <confirm-modal-form inline-template
                        id="deleteItems"
                        th:attr=" custom-header=#{admin.allUsers.deleting.title},
                                    error-message=#{admin.allUsers.deleting.error}"
                        v-bind:message="message"
                        v-bind:error-code="errorCode"
                        v-bind:value="editedValue"
                        v-on:clear-error-code="clearErrorCode"
                        v-on:confirm="onDeleteConfirm">
        <div th:insert="~{fragments/confirmModalForm :: confirmModalForm}"></div>
    </confirm-modal-form>

    <move-modal-form inline-template
                     id="moveItems"
                     ref="moveModalForm"
                     th:attr=" custom-header=#{admin.allUsers.deleting.title},
                                error-message=#{admin.allUsers.deleting.title}"
                     v-bind:message="message"
                     v-bind:operation-in-progress="dialogOperationInProgress"
                     v-on:move-confirm="onMoveConfirm">
        <div th:insert="~{drive/moveModalForm :: moveModalForm}"></div>
    </move-modal-form>

</div>

<div th:replace="fragments/profiles/activeProfile :: bottomScripts" th:remove="tag">
    <!-- jQuery -->
    <script src="../../../libs/jquery/jquery-3.2.1.min.js"></script>

    <!-- Bootstrap JS -->
    <script src="../../../libs/bootstrap/tether-1.3.3/js/tether.min.js"></script>
    <script src="../../../libs/bootstrap/js/bootstrap.min.js"></script>

    <!-- Vue.js -->
    <script src="../../../libs/vuejs/vue-2.5.16.js"></script>
</div>
<script src="../../../js/userDirectory.js" th:src="@{/js/userDirectory.js}"></script>

<script src="../../../js/alertItem.js" th:src="@{/js/alertItem.js}"></script>
<script src="../../../js/singleInputModalForm.js" th:src="@{/js/singleInputModalForm.js}"></script>
<script src="../../../js/confirmModalForm.js" th:src="@{/js/confirmModalForm.js}"></script>
<script src="../../../js/drive/moveModalForm.js" th:src="@{/js/drive/moveModalForm.js}"></script>
<script src="../../../js/drive/directory.js" th:src="@{/js/drive/directory.js}"></script>


</body>
</html>
